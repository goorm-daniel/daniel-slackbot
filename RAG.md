# 🎯 **VX 중계 AI - RAG 방식 전환 TO-DO LIST**

**목표**: Router Supervisor 방식 → RAG(Retrieval-Augmented Generation) 방식으로 전환하여 22.2% → 90%+ 성능 달성

---

## 📋 **Phase 0: 빠른 검증 및 방향 확정 (2-3일)**

### **0-1. RAG 프로토타입 구축**
- [ ] **Task 0-1-1**: 간단한 RAG 파이프라인 구현
  - 사용자 질문 → VX 데이터 검색 → 답변 생성
  - VX 데이터 일부(equipment_list만) 사용
  - 기본 임베딩 모델로 테스트

- [ ] **Task 0-1-2**: 핵심 실패 케이스 검증
  - "A7S3 카메라 추천" 
  - "OBS 노이즈 제거"
  - "강남에서 중계 준비"
  - 각각 관련 정보 검색되는지 확인

- [ ] **Task 0-1-3**: 성능 기준점 측정
  - 현재 22.2% vs RAG 프로토타입 성능 비교
  - 개선 가능성 확인

**완료 조건**: RAG 방식이 현재보다 나은 성능을 보이면 다음 Phase 진행

---

## 📋 **Phase 1: 핵심 성능 개선 (1주일)**

### **1-1. 임베딩 모델 교체 및 최적화**
- [ ] **Task 1-1-1**: 한국어 특화 임베딩 모델 적용
  ```javascript
  // 현재: 'Xenova/all-MiniLM-L6-v2' (384차원, 영어 중심)
  // 변경: 'Xenova/ko-sroberta-multitask' (768차원, 한국어 특화)
  ```
- [ ] **Task 1-1-2**: EmbeddingManager.js 업데이트
  - 새 모델로 임베딩 생성 테스트
  - 캐싱 시스템 호환성 확인
  - 성능 벤치마크 (속도, 정확도)

- [ ] **Task 1-1-3**: 임베딩 성능 검증
  - "A7S3" vs "소니 카메라" 유사도 0.8+ 달성
  - "OBS" vs "영상 송출 프로그램" 유사도 0.7+ 달성
  - VX 전문용어 간 유사도 정확성 확인

### **1-2. 하이브리드 검색 시스템 구축**
- [ ] **Task 1-2-1**: VX 키워드 맵 구축
  ```javascript
  const VX_KEYWORDS = {
    equipment: ['A7S3', '소니', 'Sony', '카메라', 'UWP-D21', 'Aputure'],
    software: ['OBS', '옵스', 'Zoom', '줌', '장면', '소스'],
    issues: ['끊김', '노이즈', '음성', '화면', '지연', '안나와'],
    locations: ['강남', '판교', '카카오테크', '타운홀', '교육장']
  }
  ```

- [ ] **Task 1-2-2**: HybridSearcher.js 구현
  ```javascript
  finalScore = (vectorScore * 0.6) + (keywordScore * 0.4)
  ```

- [ ] **Task 1-2-3**: 검색 정확도 테스트
  - Top-5 검색에서 관련 문서 포함률 80% 이상
  - 키워드 매칭 + 벡터 검색 시너지 확인

### **1-3. 첫 번째 성능 검증**
- [ ] **Task 1-3-1**: Phase 2 실패 케이스 재테스트
- [ ] **Task 1-3-2**: 성능 목표: 22.2% → 60%+ 달성
- [ ] **Task 1-3-3**: 병목지점 분석 및 다음 Phase 계획 수립

---

## 📋 **Phase 2: 데이터 품질 대폭 개선 (1주일)**

### **2-1. JSON → 자연어 변환 시스템**
- [ ] **Task 2-1-1**: AgentCorpusBuilder.js 전면 개선
  ```javascript
  // 현재: "VX팀장비관리 촬영장비 카메라 A7S3 수량 3"
  // 개선: "A7S3는 소니(Sony)의 전문 미러리스 카메라입니다. VX팀이 현재 3대를 보유하고 있으며, 저조도 환경 촬영에 특화되어 있습니다. 4K 녹화가 가능하여 중계방송용으로 자주 사용됩니다."
  ```

- [ ] **Task 2-1-2**: 데이터 소스별 변환 로직 구현
  - **equipment_list**: "장비명: XX. 브랜드: XX. 용도: XX. 특징: XX."
  - **checklists_and_faq**: "상황: XX. 문제: XX. 해결방법: XX. 관련장비: XX."  
  - **obs_guide**: "기능명: XX. 사용법: XX. 주의사항: XX."
  - **locations**: "장소: XX. 특징: XX. 세팅방법: XX."
  - **platforms**: "플랫폼: XX. 특성: XX. 권장용도: XX."
  - **zoom_guide**: "기능: XX. 설정방법: XX. 활용상황: XX."

- [ ] **Task 2-1-3**: 컨텍스트 정보 추가
  ```javascript
  {
    content: "자연어로 변환된 내용",
    metadata: {
      source: "equipment_list",
      category: "camera",
      keywords: ["A7S3", "소니", "카메라"],
      related_agents: ["EquipmentRecommendationAgent"]
    }
  }
  ```

### **2-2. 청크 단위 최적화**
- [ ] **Task 2-2-1**: 적절한 청크 크기 결정
  - 너무 작으면: 컨텍스트 부족
  - 너무 크면: 노이즈 증가
  - VX 데이터 특성에 맞는 최적 크기 실험

- [ ] **Task 2-2-2**: 의미 단위 청킹
  - 문장 단위 분할보다는 의미 단위 분할
  - 관련 정보끼리 묶어서 청크 생성

- [ ] **Task 2-2-3**: 청크 품질 검증
  - 각 청크가 독립적으로 이해 가능한지 확인
  - 중요 정보 누락 없는지 검증

### **2-3. 두 번째 성능 검증**
- [ ] **Task 2-3-1**: 데이터 품질 개선 효과 측정
- [ ] **Task 2-3-2**: 성능 목표: 60% → 75%+ 달성
- [ ] **Task 2-3-3**: 검색 품질 향상도 정량 분석

---

## 📋 **Phase 3: RAG 아키텍처 완성 (2주일)**

### **3-1. RAGController 핵심 로직 구현**
- [ ] **Task 3-1-1**: RAGController.js 신규 개발
  ```javascript
  class RAGController {
    async processQuery(userQuery) {
      // 1. 질문 분석 및 키워드 추출
      // 2. 하이브리드 검색으로 Top-K 관련 정보 검색
      // 3. 검색된 정보를 컨텍스트로 답변 생성
      // 4. 답변 품질 검증 및 후처리
    }
  }
  ```

- [ ] **Task 3-1-2**: RouterSupervisor.js를 RAG 방식으로 전환
  - 기존 에이전트 선택 로직 → 직접 검색 로직으로 변경
  - 8개 에이전트 → 참고용 컨텍스트로 역할 변경

- [ ] **Task 3-1-3**: 검색-생성 파이프라인 구축
  - Query → Retrieval → Generation 플로우 구현
  - 각 단계별 로깅 및 디버깅 기능 추가

### **3-2. LLM 답변 생성 시스템**
- [ ] **Task 3-2-1**: AnswerGenerator.js 구현
  ```javascript
  const prompt = `
  당신은 VX팀의 중계 전문가입니다.
  
  사용자 질문: ${userQuery}
  
  관련 정보:
  ${relevantChunks.map(chunk => chunk.content).join('\n\n')}
  
  위 정보를 바탕으로 정확하고 실용적인 답변을 해주세요.
  - 구체적인 단계별 방법 제시
  - VX팀 실제 장비/환경 기준으로 설명
  - 주의사항이 있다면 반드시 포함
  `;
  ```

- [ ] **Task 3-2-2**: LLM API 연동 (OpenAI 또는 로컬 모델)
  - API 키 관리 및 보안
  - 요청/응답 최적화
  - 에러 처리 및 폴백 로직

- [ ] **Task 3-2-3**: 프롬프트 엔지니어링
  - VX 중계 전문가 페르소나 구축
  - 답변 품질 향상을 위한 프롬프트 최적화
  - 다양한 질문 유형별 프롬프트 템플릿

### **3-3. 통합 시스템 테스트**
- [ ] **Task 3-3-1**: End-to-End 테스트
  - 사용자 질문부터 최종 답변까지 전체 플로우 검증
  - 응답 시간 3초 이내 달성

- [ ] **Task 3-3-2**: 성능 목표: 75% → 85%+ 달성
- [ ] **Task 3-3-3**: 사용성 테스트 (VX팀 피드백 수집)

---

## 📋 **Phase 4: 고도화 및 최적화 (2주일)**

### **4-1. 멀티체인 구조 도입**
- [ ] **Task 4-1-1**: 질문 유형별 체인 분리
  ```javascript
  const CHAIN_TYPES = {
    equipment_recommendation: '장비 추천',
    troubleshooting: '문제 해결',
    setup_guide: '세팅 가이드',
    obs_help: 'OBS 도움말',
    platform_guide: '플랫폼 가이드',
    location_specific: '장소별 가이드'
  }
  ```

- [ ] **Task 4-1-2**: 질문 유형 자동 분류기 구현
- [ ] **Task 4-1-3**: 체인별 특화 검색 및 답변 로직 개발

### **4-2. 성능 모니터링 및 평가 시스템**
- [ ] **Task 4-2-1**: VX 평가 데이터셋 구축
  - 실제 VX팀이 받는 질문들 수집
  - 정답/오답 기준 명확화
  - 지속적 평가를 위한 테스트 케이스 확장

- [ ] **Task 4-2-2**: 자동 평가 시스템 구현
  - 검색 정확도 (관련 문서 포함률)
  - 답변 품질 (키워드 포함도, 완성도)
  - 사용자 만족도 점수

- [ ] **Task 4-2-3**: 실시간 모니터링 대시보드
  - 질문 유형별 성공률
  - 응답 시간 분포  
  - 오류 발생 빈도

### **4-3. 캐싱 및 성능 최적화**
- [ ] **Task 4-3-1**: 다층 캐싱 시스템 구축
  - 임베딩 캐시 (계산 비용 절약)
  - 검색 결과 캐시 (유사 질문 빠른 처리)
  - LLM 답변 캐시 (중복 질문 즉시 응답)

- [ ] **Task 4-3-2**: 메모리 및 성능 최적화
- [ ] **Task 4-3-3**: 성능 목표: 85% → 90%+ 달성

---

## 📋 **Phase 5: 운영 환경 및 지속 개선 (1주일)**

### **5-1. 프로덕션 환경 구축**
- [ ] **Task 5-1-1**: API 엔드포인트 구현
- [ ] **Task 5-1-2**: 웹 인터페이스 또는 챗봇 연동
- [ ] **Task 5-1-3**: 로깅 및 모니터링 시스템 구축

### **5-2. 지속적 개선 파이프라인**
- [ ] **Task 5-2-1**: 신규 VX 데이터 자동 업데이트
- [ ] **Task 5-2-2**: 사용자 피드백 기반 성능 개선
- [ ] **Task 5-2-3**: A/B 테스트 환경 구축

### **5-3. 최종 성능 검증**
- [ ] **Task 5-3-1**: 전체 시스템 통합 테스트
- [ ] **Task 5-3-2**: 성능 목표: 90% → 95%+ 달성  
- [ ] **Task 5-3-3**: VX팀 실무진 사용성 검증

---

## 🎯 **예상 성능 로드맵**

| Phase | 목표 성능 | 핵심 개선 요소 | 예상 기간 |
|-------|-----------|----------------|-----------|
| Phase 0 | 검증 | RAG 프로토타입 | 2-3일 |
| Phase 1 | 60%+ | 한국어 모델 + 하이브리드 검색 | 1주일 |
| Phase 2 | 75%+ | 고품질 데이터 전처리 | 1주일 |
| Phase 3 | 85%+ | RAG 아키텍처 + LLM 답변 생성 | 2주일 |
| Phase 4 | 90%+ | 멀티체인 + 평가 시스템 | 2주일 |
| Phase 5 | 95%+ | 운영 최적화 | 1주일 |

## 🚀 **시작 권장 순서**

1. **Phase 0** - RAG 방식 가능성 검증 (필수!)
2. **Phase 1-1** - 임베딩 모델 교체 (즉시 효과)  
3. **Phase 2-1** - 데이터 품질 개선 (최대 임팩트)
4. **Phase 1-2** - 하이브리드 검색 구현
5. **Phase 3** - 완전한 RAG 시스템 구축
